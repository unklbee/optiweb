<!-- templates/base.html -->
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO Meta Tags -->
    <title>{% block title %}Service Laptop Bandung Terpercaya | Reparasi Laptop Profesional | optiontech.id{% endblock %}</title>
    <meta name="description"
          content="{% block description %}Layanan service laptop terpercaya di Bandung. Teknisi berpengalaman, garansi resmi, harga terjangkau.{% endblock %}">
    <meta name="keywords"
          content="{% block keywords %}service laptop bandung, reparasi laptop bandung, teknisi laptop bandung{% endblock %}">
    <meta name="author"
          content="{% if business_info %}{{ business_info.business_name }}{% else %}Service Laptop Bandung{% endif %}">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="{% block og_title %}Service Laptop Bandung{% endblock %}">
    <meta property="og:description"
          content="{% block og_description %}Layanan service laptop terpercaya di Bandung{% endblock %}">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    <meta property="og:image" content="

    {% block og_image %}{% load static %}{{ request.scheme }}://{{ request.get_host }}{% static 'img/logo-og.jpg' %}{% endblock %}">

    <!-- Schema Markup -->
    {% load schema_tags %}
    {% local_business_schema business_info %}

    <!-- Additional page-specific schemas will be added in child templates -->
    {% block extra_schema %}{% endblock %}

    <!-- CSS -->
    {% load static %}
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{% static 'img/favicon.ico' %}">

    <!-- Google Analytics -->
    {% if settings.GOOGLE_ANALYTICS_ID %}
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id={{ settings.GOOGLE_ANALYTICS_ID }}"></script>
        <script>
            window.dataLayer = window.dataLayer || [];

            function gtag() {
                dataLayer.push(arguments);
            }

            gtag('js', new Date());
            gtag('config', '{{ settings.GOOGLE_ANALYTICS_ID }}');
        </script>
    {% endif %}

    <!-- Site Verification Meta Tags -->
    {% if settings.GOOGLE_SITE_VERIFICATION %}
        <meta name="google-site-verification" content="{{ settings.GOOGLE_SITE_VERIFICATION }}">
    {% endif %}
    {% if settings.BING_SITE_VERIFICATION %}
        <meta name="msvalidate.01" content="{{ settings.BING_SITE_VERIFICATION }}">
    {% endif %}
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
<!-- Header -->
<header class="bg-blue-600 text-white shadow-lg">
    <div class="container mx-auto px-4">
        <!-- Top Bar -->
        {% if business_info %}
            <div class="hidden md:flex justify-between items-center py-2 text-sm border-b border-blue-500">
                <div class="flex space-x-4">
                    <span><i class="fas fa-envelope mr-1"></i>{{ business_info.email }}</span>
                    <span><i class="fas fa-clock mr-1"></i>Senin-Sabtu 08:00-20:00</span>
                </div>
                <div class="flex space-x-4">
                    <a href="tel:{{ business_info.phone }}" class="hover:text-blue-200">
                        <i class="fas fa-phone mr-1"></i>{{ business_info.phone }}
                    </a>
                    <a href="https://wa.me/{{ business_info.whatsapp }}" target="_blank" class="hover:text-blue-200">
                        <i class="fab fa-whatsapp mr-1"></i>WhatsApp
                    </a>
                </div>
            </div>
        {% endif %}

        <!-- Main Navigation -->
        <nav class="py-4">
            <div class="flex justify-between items-center">
                <!-- Logo -->
                <div class="flex items-center">
                    <a href="{% url 'home' %}" class="text-2xl font-bold">
                        {% if business_info %}
                            {{ business_info.business_name }}
                        {% else %}
                            Service Laptop Bandung
                        {% endif %}
                    </a>
                </div>

                <!-- Desktop Menu -->
                <div class="hidden md:flex space-x-6">
                    <a href="{% url 'home' %}" class="hover:text-blue-200 transition-colors">Beranda</a>

                    <!-- Services Dropdown with JavaScript -->
                    <div class="relative" id="services-dropdown">
                        <button class="hover:text-blue-200 transition-colors flex items-center focus:outline-none"
                                id="services-button">
                            Layanan <i class="fas fa-chevron-down ml-1 transform transition-transform duration-200"
                                       id="services-icon"></i>
                        </button>
                        <div class="absolute top-full left-0 mt-2 w-64 bg-white text-gray-800 rounded-lg shadow-lg opacity-0 invisible transform scale-95 transition-all duration-200 z-50"
                             id="services-menu">
                            <div class="p-4">
                                <a href="{% url 'services:list' %}"
                                   class="block py-2 px-3 hover:bg-blue-50 rounded transition-colors">
                                    Semua Layanan
                                </a>
                                {% for category in nav_service_categories %}
                                    <a href="{% url 'services:category' category.slug %}"
                                       class="block py-2 px-3 hover:bg-blue-50 rounded transition-colors">
                                        {% if category.icon %}<i class="{{ category.icon }} mr-2"></i>{% endif %}
                                        {{ category.name }}
                                    </a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    <!-- Blog -->
                    <a href="{% url 'content:blog_list' %}" class="hover:text-blue-200 transition-colors">Blog</a>
                    <!-- FAQ -->
                    <a href="{% url 'content:faq' %}" class="hover:text-blue-200 transition-colors">FAQ</a>
                    <!-- Testimonial -->
                    <a href="{% url 'content:testimonials' %}"
                       class="hover:text-blue-200 transition-colors">Testimonial</a>
                    <!-- Tentang Kami - fix this -->
                    <a href="{% url 'content:about' %}" class="hover:text-blue-200 transition-colors">Tentang Kami</a>
                    <!-- Contact - fix this -->
                    <a href="{% url 'content:contact' %}" class="hover:text-blue-200 transition-colors">Kontak</a>

                    {% if user.is_authenticated %}
                        <div class="relative group">
                            <button class="hover:text-blue-200 transition-colors flex items-center">
                                <i class="fas fa-user mr-1"></i>
                                {{ user.get_full_name|default:user.username }}
                                <i class="fas fa-chevron-down ml-1"></i>
                            </button>
                            <div class="absolute top-full right-0 mt-2 w-48 bg-white text-gray-800 rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                                <div class="p-2">
                                    <a href="{% url 'customers:dashboard' %}" class="block py-2 px-3 hover:bg-blue-50 rounded">
                                        <i class="fas fa-tachometer-alt mr-2"></i>Dashboard
                                    </a>
                                    <a href="{% url 'customers:orders' %}" class="block py-2 px-3 hover:bg-blue-50 rounded">
                                        <i class="fas fa-list mr-2"></i>Order Saya
                                    </a>
                                    <a href="{% url 'customers:loyalty' %}" class="block py-2 px-3 hover:bg-blue-50 rounded">
                                        <i class="fas fa-star mr-2"></i>Program Loyalty
                                    </a>
                                    <a href="{% url 'customers:profile' %}" class="block py-2 px-3 hover:bg-blue-50 rounded">
                                        <i class="fas fa-user-edit mr-2"></i>Profile
                                    </a>
                                    <hr class="my-2">
                                    <a href="{% url 'customers:logout' %}" class="block py-2 px-3 hover:bg-red-50 rounded text-red-600">
                                        <i class="fas fa-sign-out-alt mr-2"></i>Logout
                                    </a>
                                </div>
                            </div>
                        </div>
                    {% else %}
                        <a href="{% url 'customers:login' %}" class="hover:text-blue-200 transition-colors">
                            <i class="fas fa-sign-in-alt mr-1"></i>Login
                        </a>
                        <a href="{% url 'customers:register' %}" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                            <i class="fas fa-user-plus mr-1"></i>Daftar
                        </a>
                    {% endif %}
                </div>

                <!-- Mobile Menu Button -->
                <div class="md:hidden">
                    <button id="mobile-menu-btn" class="text-white">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>

            <!-- Mobile Menu -->
            <div id="mobile-menu" class="md:hidden mt-4 pb-4 hidden">
                <div class="space-y-2">
                    <a href="{% url 'home' %}" class="block py-2 hover:text-blue-200">Beranda</a>
                    <a href="{% url 'services:list' %}" class="block py-2 hover:text-blue-200">Semua Layanan</a>
                    {% for category in nav_service_categories %}
                        <a href="{% url 'services:category' category.slug %}"
                           class="block py-2 pl-4 hover:text-blue-200">
                            {{ category.name }}
                        </a>
                    {% endfor %}
                    <a href="{% url 'content:blog_list' %}" class="block py-2 hover:text-blue-200">Blog</a>
                    <a href="{% url 'content:faq' %}" class="block py-2 hover:text-blue-200">FAQ</a>
                    <a href="{% url 'content:testimonials' %}" class="block py-2 hover:text-blue-200">Testimonial</a>
                    <a href="{% url 'content:about' %}" class="block py-2 hover:text-blue-200">Tentang Kami</a>
                    <a href="{% url 'content:contact' %}" class="block py-2 hover:text-blue-200">Kontak</a>
                </div>
            </div>
        </nav>
    </div>
</header>

<!-- Main Content -->
<main class="flex-grow container mx-auto px-4 py-8">
    {% block content %}
    {% endblock %}
</main>

<!-- Footer -->
<footer class="bg-gray-800 text-white mt-auto">
    <div class="container mx-auto px-4 py-8">
        <div class="grid md:grid-cols-4 gap-8">
            <!-- Company Info -->
            <div>
                <h3 class="text-lg font-semibold mb-4">
                    {% if business_info %}{{ business_info.business_name }}{% else %}Service Laptop Bandung{% endif %}
                </h3>
                {% if business_info %}
                    <p class="text-gray-300 text-sm mb-2">{{ business_info.address }}</p>
                    <p class="text-gray-300 text-sm mb-2">{{ business_info.phone }}</p>
                    <p class="text-gray-300 text-sm">{{ business_info.email }}</p>
                {% endif %}
            </div>

            <!-- Services -->
            <div>
                <h3 class="text-lg font-semibold mb-4">Layanan Kami</h3>
                <ul class="space-y-2 text-sm">
                    {% for category in nav_service_categories %}
                        <li>
                            <a href="{% url 'services:category' category.slug %}"
                               class="text-gray-300 hover:text-white">
                                {{ category.name }}
                            </a>
                        </li>
                    {% endfor %}
                    <li>
                        <a href="{% url 'services:list' %}" class="text-blue-400 hover:text-blue-300">
                            Lihat Semua »
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Brands -->
            <div>
                <h3 class="text-lg font-semibold mb-4">Brand yang Dilayani</h3>
                <div class="grid grid-cols-2 gap-2 text-sm">
                    {% for brand in nav_brands %}
                        <span class="text-gray-300">{{ brand.name }}</span>
                    {% endfor %}
                </div>
            </div>

            <!-- Contact CTA -->
            <div>
                <h3 class="text-lg font-semibold mb-4">Hubungi Kami</h3>
                {% if business_info %}
                    <div class="space-y-3">
                        <a href="https://wa.me/{{ business_info.whatsapp }}"
                           target="_blank"
                           class="flex items-center bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition-colors">
                            <i class="fab fa-whatsapp mr-2"></i>
                            WhatsApp
                        </a>
                        <a href="tel:{{ business_info.phone }}"
                           class="flex items-center bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors">
                            <i class="fas fa-phone mr-2"></i>
                            Telepon
                        </a>
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- Copyright -->
        <div class="border-t border-gray-700 mt-8 pt-4 text-center text-gray-400 text-sm">
            <p>&copy; {{ "now"|date:"Y" }}
                {% if business_info %}{{ business_info.business_name }}{% else %}Service Laptop Bandung{% endif %}. All
                rights reserved.</p>
        </div>
    </div>
</footer>
{% block extra_js %}{% endblock %}
<!-- JavaScript - ganti yang lama dengan ini -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');

        if (mobileMenuBtn && mobileMenu) {
            mobileMenuBtn.addEventListener('click', function () {
                mobileMenu.classList.toggle('hidden');
            });

            // Close mobile menu when clicking outside
            document.addEventListener('click', function (event) {
                if (!mobileMenuBtn.contains(event.target) && !mobileMenu.contains(event.target)) {
                    mobileMenu.classList.add('hidden');
                }
            });
        }

        // Desktop Services Dropdown
        const servicesButton = document.getElementById('services-button');
        const servicesMenu = document.getElementById('services-menu');
        const servicesIcon = document.getElementById('services-icon');
        const servicesDropdown = document.getElementById('services-dropdown');

        if (servicesButton && servicesMenu) {
            let isOpen = false;

            // Toggle dropdown on button click
            servicesButton.addEventListener('click', function (e) {
                e.preventDefault();
                toggleDropdown();
            });

            // Show dropdown on hover
            servicesDropdown.addEventListener('mouseenter', function () {
                if (!isOpen) {
                    showDropdown();
                }
            });

            // Hide dropdown when mouse leaves
            servicesDropdown.addEventListener('mouseleave', function () {
                hideDropdown();
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function (event) {
                if (!servicesDropdown.contains(event.target)) {
                    hideDropdown();
                }
            });

            function toggleDropdown() {
                if (isOpen) {
                    hideDropdown();
                } else {
                    showDropdown();
                }
            }

            function showDropdown() {
                isOpen = true;
                servicesMenu.classList.remove('opacity-0', 'invisible', 'scale-95');
                servicesMenu.classList.add('opacity-100', 'visible', 'scale-100');
                servicesIcon.style.transform = 'rotate(180deg)';
            }

            function hideDropdown() {
                isOpen = false;
                servicesMenu.classList.remove('opacity-100', 'visible', 'scale-100');
                servicesMenu.classList.add('opacity-0', 'invisible', 'scale-95');
                servicesIcon.style.transform = 'rotate(0deg)';
            }
        }
    });
</script>
</body>
</html>